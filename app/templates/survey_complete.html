<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey Complete - Mental Health Project</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <style>
        body {
            background-color: #f5f5f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .recommendations-container {
    background-color: #f8f9fa;
    border-radius: 10px;
    padding: 2rem;
    margin-top: 2rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.recommendation-card {
    background-color: white;
    border-radius: 8px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    border-left: 4px solid #0d6efd;
}

.recommendation-card h4 {
    color: #0d6efd;
    margin-bottom: 0.5rem;
}

.rationale {
    color: #6c757d;
    font-style: italic;
    margin-top: 0.5rem;
}

.processing-message {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.fallback-recommendations {
    background-color: #e9ecef;
    padding: 1rem;
    border-radius: 8px;
}

.btn {
    display: inline-block;
    margin-top: 1rem;
    padding: 0.5rem 1rem;
    background: #4e73df;
    color: white;
    text-decoration: none;
    border-radius: 4px;
}
    </style>
</head>
<body>
    {% include 'header.html' %}


<!-- Main Content -->
<main class="container">
    <div class="recommendations-container">
        <h2>Your Personalized Suggestions</h2>
        
        {% if recommendations %}
            {% if recommendations is string %}
                <!-- Handle case where recommendations is a string -->
                <div class="recommendations-list">
                    <div class="recommendation-card">
                        <h4>General</h4>
                        <p>{{ recommendations }}</p>
                    </div>
                </div>
            {% elif recommendations is mapping %}
                <!-- Handle case where single recommendation is a dictionary -->
                <div class="recommendations-list">
                    <div class="recommendation-card">
                        <h4>{{ recommendations.category }}</h4>
                        <p>{{ recommendations.text }}</p>
                        {% if recommendations.rationale %}
                        <p class="rationale"><small>{{ recommendations.rationale }}</small></p>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <!-- Normal list of recommendations -->
                <div class="recommendations-list">
                    {% for rec in recommendations %}
                    <div class="recommendation-card">
                        {% if rec is string %}
                            <h4>General</h4>
                            <p>{{ rec }}</p>
                        {% else %}
                            <h4>{{ rec.get('category', 'General') }}</h4>
                            <p>{{ rec.get('text', '') }}</p>
                            {% if rec.get('rationale') %}
                            <p class="rationale"><small>{{ rec.rationale }}</small></p>
                            {% endif %}
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% else %}
            <div class="processing-message">
                <p>We're preparing your personalized suggestions...</p>
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
            <div class="fallback-recommendations mt-4">
                <p class="text-muted">Try these general wellness tips while you wait:</p>
                <ul class="list-group">
                    <li class="list-group-item">Take three deep breaths</li>
                    <li class="list-group-item">Drink a glass of water</li>
                    <li class="list-group-item">Step outside for fresh air</li>
                </ul>
            </div>
        {% endif %}
    </div>
</main>

<!-- Refresh meta tag for auto-reload -->
<meta http-equiv="refresh" content="5;url={{ url_for('main.survey_complete') }}">

     {% include 'footer.html' %}

    <!-- Bootstrap JS and Font Awesome -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>
</html>